"use strict";(self.webpackChunkfastify_website=self.webpackChunkfastify_website||[]).push([[3187],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return g}});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),f=p(n),g=i,d=f["".concat(l,".").concat(g)]||f[g]||c[g]||o;return n?r.createElement(d,a(a({ref:t},u),{},{components:n})):r.createElement(d,a({ref:t},u))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=f;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var p=2;p<o;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},2030:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return u},default:function(){return f}});var r=n(7462),i=n(3366),o=(n(7294),n(3905)),a=["components"],s={title:"Logging",sidebar_label:"Logging",hide_title:!1},l=void 0,p={unversionedId:"Logging",id:"version-v1/Logging",isDocsHomePage:!1,title:"Logging",description:"Logging is disabled by default, and you can enable it by passing",source:"@site/versioned_docs/version-v1/Logging.md",sourceDirName:".",slug:"/Logging",permalink:"/website-next/docs/v1/Logging",editUrl:"https://github.com/fastify/website-next/edit/main/docs/versioned_docs/version-v1/Logging.md",tags:[],version:"v1",frontMatter:{title:"Logging",sidebar_label:"Logging",hide_title:!1},sidebar:"version-v1/sidebar",previous:{title:"Lifecycle",permalink:"/website-next/docs/v1/Lifecycle"},next:{title:"Middlewares",permalink:"/website-next/docs/v1/Middlewares"}},u=[],c={toc:u};function f(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Logging is disabled by default, and you can enable it by passing\n",(0,o.kt)("inlineCode",{parentName:"p"},"{ logger: true }")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"{ logger: { level: 'info' } }")," when you create\nthe fastify instance. Note that if the logger is disabled, it is impossible to\nenable it at runtime. We use\n",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/abstract-logging"},"abstract-logging")," for\nthis purpose."),(0,o.kt)("p",null,"Since Fastify is really focused on performances, it uses ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/pinojs/pino"},"pino")," as its logger, with the default log level, when enabled, set to ",(0,o.kt)("inlineCode",{parentName:"p"},"'info'"),"."),(0,o.kt)("p",null,"Enabling the logger is extremely easy:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const fastify = require('fastify')({\n  logger: true\n})\n\nfastify.get('/', options, function (request, reply) {\n  request.log.info('Some info about the current request')\n  reply.send({ hello: 'world' })\n})\n")),(0,o.kt)("p",null,"If you want to pass some options to the logger, just pass the logger option to Fastify.\nYou can find all the options in the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/pinojs/pino/blob/master/docs/api.md#pinooptions-stream"},"Pino documentation"),". If you want to pass a custom stream to the Pino instance, just add the stream field to the logger object."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const split = require('split2')\nconst stream = split(JSON.parse)\n\nconst fastify = require('fastify')({\n  logger: {\n    level: 'info',\n    stream: stream\n  }\n})\n\nfastify.get('/', options, function (request, reply) {\n  request.log.info('Some info about the current request')\n  reply.send({ hello: 'world' })\n})\n")),(0,o.kt)("a",{name:"logging-request-id"}),(0,o.kt)("p",null,'By default fastify adds an id to every request for easier tracking. If the "request-id" header is present its value is used, otherwise a new incremental id is generated. See Fastify Factory ',(0,o.kt)("a",{parentName:"p",href:"/website-next/docs/v1/Server#factory-request-id-header"},(0,o.kt)("inlineCode",{parentName:"a"},"requestIdHeader"))," options for customizing that header name.\nAdditionally, ",(0,o.kt)("inlineCode",{parentName:"p"},"genReqId")," option can be used for generating the request id by yourself. It will received the incoming request as a parameter."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let i = 0\nconst fastify = require('fastify')({\n  logger: {\n    genReqId: function (req) { return i++ }\n  }\n})\n")),(0,o.kt)("p",null,"The default logger is configured with a set of standard serializers that serialize objects with ",(0,o.kt)("inlineCode",{parentName:"p"},"req"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"res"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"err")," properties. This behavior can be customized by specifying custom serializers."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const fastify = require('fastify')({\n  logger: {\n    serializers: {\n      req: function (req) {\n        return { url: req.url }\n      }\n    }\n  }\n})\n")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"This option will be ignored by any logger other than Pino.")),(0,o.kt)("p",null,"You can also supply your own logger instance. Instead of passing configuration options, simply pass the instance.\nThe logger you supply must conform to the Pino interface; that is, it must have the following methods:\n",(0,o.kt)("inlineCode",{parentName:"p"},"info"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"error"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"debug"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"fatal"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"warn"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"trace"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"child"),"."),(0,o.kt)("p",null,"Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const log = require('pino')({ level: 'info' })\nconst fastify = require('fastify')({ logger: log })\n\nlog.info('does not have request information')\n\nfastify.get('/', function (request, reply) {\n  request.log.info('includes request information, but is the same logger instance as `log`')\n  reply.send({ hello: 'world' })\n})\n")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"The logger instance for the current request is available in every part of the ",(0,o.kt)("a",{parentName:"em",href:"/website-next/docs/v1/Lifecycle"},"lifecycle"),".")))}f.isMDXComponent=!0}}]);